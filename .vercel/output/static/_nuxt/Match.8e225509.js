import{_ as $}from"./PlayingCard.vue.5eb94ca1.js";import{_ as K}from"./Button.vue.4d27957a.js";import{f as N,o as c,c as g,F as T,j as E,g as b,n as M,k as q,l as y,m as C,q as Q,d as U,t as W,u as k,a as S,b as x,s as X,_ as Y}from"./entry.545dcbc7.js";import{u as Z}from"./state.50b16471.js";import"./Icon.4cedce90.js";import"./index.df58e121.js";var _=(m=>(m.River="RIVER",m.Lake="LAKE",m.Stack="STACK",m.Nerts="NERTS",m))(_||{});const ee={key:0,class:"flex cursor-pointer select-none"},ae=N({__name:"NertsPile",props:{cards:{},draggable:{type:Boolean}},emits:["click"],setup(m,{emit:v}){const l=v,d=m;function n(a,f){const r={cards:d.cards.slice(f),fromLocation:{locationType:_.Nerts,index:0}};a.dataTransfer&&(a.dataTransfer.setData("text/plain",JSON.stringify(r)),a.dataTransfer.dropEffect="move")}return(a,f)=>{const r=$,u=K;return a.cards.length>0?(c(),g("div",ee,[a.cards.length>0?(c(!0),g(T,{key:0},E(a.cards,(p,o)=>(c(),b(r,{class:"-mr-16",style:M({"z-index":`${o}`}),card:p,key:o,onDrag:i=>n(i,o),draggable:a.draggable&&o==a.cards.length-1},null,8,["style","card","onDrag","draggable"]))),128)):q("",!0)])):(c(),b(u,{key:1,label:"NERTS",onClick:f[0]||(f[0]=p=>l("click"))}))}}}),re=N({__name:"Deck",props:{cards:{}},emits:["click"],setup(m,{emit:v}){const l=v;return y(0),(d,n)=>(c(),g("div",{onClick:n[0]||(n[0]=a=>l("click")),class:C(`border-4 border-slate-700 w-24 h-32 cursor-pointer select-none ${d.cards.length>0?"bg-slate-500":""}`)},null,2))}}),te={key:1,class:C("border-2 border-slate-300 w-24 h-32 bg-slate-200 flex flex-col justify-between")},ne=N({__name:"Stack",props:{cards:{},draggable:{type:Boolean}},emits:["clicked"],setup(m,{emit:v}){const l=m;function d(n){const a={cards:[l.cards[l.cards.length-1]],fromLocation:{locationType:_.Stack,index:0}};n.dataTransfer&&(n.dataTransfer.setData("text/plain",JSON.stringify(a)),n.dataTransfer.dropEffect="move")}return(n,a)=>{const f=$;return n.cards.length>0?(c(),b(f,{key:0,card:n.cards[n.cards.length-1],draggable:n.draggable,onDrag:d},null,8,["card","draggable"])):(c(),g("div",te))}}}),se={class:"flex flex-col relative"},oe=N({__name:"RiverStack",props:{cards:{},index:{},draggable:{type:Boolean}},emits:["drop"],setup(m,{emit:v}){const l=v,d=m;function n(r){r.preventDefault(),r.dataTransfer&&(r.dataTransfer.dropEffect="move")}function a(r){var p;const u=(p=r.dataTransfer)==null?void 0:p.getData("text/plain");if(u){const o=JSON.parse(u);console.log(o),l("drop",o)}}function f(r,u){const p={cards:d.cards.slice(u),fromLocation:{locationType:_.River,index:d.index}};r.dataTransfer&&(r.dataTransfer.setData("text/plain",JSON.stringify(p)),r.dataTransfer.dropEffect="move")}return(r,u)=>{const p=$;return c(),g("div",se,[r.cards.length>0?(c(!0),g(T,{key:0},E(r.cards,(o,i)=>(c(),b(p,{class:"-mb-24",style:M({"z-index":`${i}`}),card:o,key:i,onDrag:A=>f(A,i),onDrop:a,draggable:r.draggable},null,8,["style","card","onDrag","draggable"]))),128)):(c(),g("div",{key:1,class:C("border-2 border-slate-300 w-24 h-32 bg-slate-200 flex flex-col justify-between"),onDrop:a,onDragover:n},null,32))])}}}),ce=N({__name:"LakeStack",props:{cards:{}},emits:["drop"],setup(m,{emit:v}){const l=v;function d(a){var r;const f=(r=a.dataTransfer)==null?void 0:r.getData("text/plain");if(f){const u=JSON.parse(f);console.log(u),u.cards.length==1&&l("drop",u)}}function n(a){a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect="move")}return(a,f)=>{const r=$;return a.cards.length>0?(c(),b(r,{key:0,card:a.cards[a.cards.length-1],onDrop:d,draggable:!1},null,8,["card"])):(c(),g("div",{key:1,class:C("border-2 border-slate-300 w-24 h-32 bg-slate-200 flex flex-col justify-between"),onDrop:d,onDragover:n},null,32))}}}),le={class:"flex flex-col justify-evenly h-full w-10/12"},ie={class:"rotate-180 flex justify-evenly"},de={class:"flex justify-between"},ue={class:"flex justify-center"},fe={class:"flex justify-evenly"},me={class:"flex justify-between"},pe=N({__name:"MatchBoard",setup(m){const v=y([]),l=y([]),d=y([]),n=y(Array.from(Array(5),()=>[])),a=y(Array.from(Array(8),()=>[])),f=y([]),r=y([]),u=y([]),p=y(Array.from(Array(5),()=>[])),o=Z("username",()=>""),{$io:i}=X();i.auth={username:o.value},i.connect(),i.on("message",e=>{console.log(e)}),i.on("startGame",e=>{console.log(e),Object.keys(e.usersides).forEach(t=>{const s=e.usersides[t];t==o.value?(v.value=s.nertsPile,n.value=s.riverStacks,l.value=s.deck):(f.value=s.nertsPile,p.value=s.riverStacks,r.value=s.deck)})}),i.on("matchError",async()=>{await Q("/")}),i.on("dropResponse",e=>{switch(e.toLocation.locationType){case _.Lake:I(e);break;case _.River:A(e);break}switch(e.fromLocation.locationType){case _.River:j(e);break;case _.Nerts:O(e);case _.Stack:R(e)}}),i.on("dealResponse",e=>{V(e)}),i.on("reshuffleResponse",e=>{e.userId==o.value?(l.value=e.cards,d.value=[]):(r.value=e.cards,u.value=[])});function A(e){const s=(o.value==e.userId?n.value:p.value)[e.toLocation.index];e.cards.forEach(D=>{s.push(D)})}function j(e){let s=(o.value==e.userId?n.value:p.value)[e.fromLocation.index];e.cards.forEach(D=>{s.splice(s.indexOf(D),1)})}function O(e){let t=o.value==e.userId?v.value:f.value;e.cards.forEach(s=>{t.splice(t.indexOf(s),1)})}function R(e){let t=o.value==e.userId?d.value:u.value;e.cards.forEach(s=>{t.splice(t.indexOf(s),1)})}function I(e){e.cards.forEach(t=>{a.value[e.toLocation.index].push(t)})}function B(e,t){console.log("DROPPING",e),i.emit("dropAction",{userId:o.value,cards:e.cards,toLocation:{locationType:_.River,index:t},fromLocation:e.fromLocation})}function F(e,t){i.emit("dropAction",{userId:o.value,cards:e.cards,toLocation:{locationType:_.Lake,index:t},fromLocation:e.fromLocation})}function J(){i.emit("dealAction")}function V(e){if(e==o.value){const t=l.value.slice(0,3),s=l.value.slice(t.length);l.value=s,d.value=d.value.concat(t)}else{const t=r.value.slice(0,3),s=r.value.slice(t.length);r.value=s,u.value=u.value.concat(t)}}function z(){i.emit("nertsAction")}return(e,t)=>{const s=ae,D=re,w=ne,H=oe,G=ce;return c(),g(T,null,[U(W(k(o))+" ",1),S("div",le,[S("div",ie,[x(s,{draggable:!1,cards:k(f)},null,8,["cards"]),S("div",de,[x(D,{class:"mx-4",cards:k(r)},null,8,["cards"]),x(w,{draggable:!1,cards:k(u)},null,8,["cards"])]),(c(!0),g(T,null,E(k(p),(L,h)=>(c(),b(H,{draggable:!1,cards:L,key:h,index:h},null,8,["cards","index"]))),128))]),S("div",ue,[(c(!0),g(T,null,E(k(a),(L,h)=>(c(),b(G,{onDrop:P=>F(P,h),class:"mx-4",cards:L,key:h},null,8,["onDrop","cards"]))),128))]),S("div",fe,[x(s,{onClick:z,draggable:!0,cards:k(v)},null,8,["cards"]),S("div",me,[x(D,{class:"mx-4",cards:k(l),onClick:J},null,8,["cards"]),x(w,{draggable:!0,cards:k(d)},null,8,["cards"])]),(c(!0),g(T,null,E(k(n),(L,h)=>(c(),b(H,{draggable:!0,onDrop:P=>B(P,h),cards:L,key:h,index:h},null,8,["onDrop","cards","index"]))),128))])])],64)}}}),ve={};function ge(m,v){const l=pe;return c(),b(l)}const Se=Y(ve,[["render",ge]]);export{Se as default};
